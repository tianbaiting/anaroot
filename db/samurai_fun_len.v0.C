// -*- mode: c++ -*-
// 
// File O24_length.C generated by TMultiDimFit::MakeRealCode
// on Tue Nov 10 13:52:02 2015
// ROOT version 5.32/00
//
// This file contains the function 
//
//    double  MDF(double *x); 
//
// For evaluating the parameterization obtained
// from TMultiDimFit and the point x
// 
// See TMultiDimFit class documentation for more information 
// 
//
// Static data variables
//
static int    gNVariables    = 6;
static int    gNCoefficients = 77;
static double gDMean         = 9028.41;
// Assignment to mean vector.
static double gXMean[] = {
  0.0187355, -0.00218687, -0.00289588, -0.00952437, 0.106203, -0.40635 };

// Assignment to minimum vector.
static double gXMin[] = {
  -204.857, -135.487, -0.0885213, -0.0770279, -1147.98, -393.282 };

// Assignment to maximum vector.
static double gXMax[] = {
  197.202, 138.356, 0.0912616, 0.0785179, 1126.78, 932.549 };

// Assignment to coefficients vector.
static double gCoefficient[] = {
  683.027,
  1570.61,
  209.287,
  -785.223,
  649.456,
  -1634.5,
  148.427,
  666.836,
  94.4862,
  169.557,
  -17.9938,
  88.2733,
  -1457.6,
  776.956,
  3335.97,
  318.849,
  -667.395,
  -46.4201,
  -75.6828,
  -23.2595,
  -15.678,
  -2.16377,
  0.720537,
  3.25824,
  -56.5939,
  322.007,
  -3683.13,
  8358.54,
  2064.43,
  333.396,
  327.214,
  797.653,
  205.624,
  674.819,
  -215.968,
  542.39,
  -389.691,
  -19.3167,
  -593.881,
  881.862,
  541.313,
  779.448,
  -548.116,
  15.6204,
  12.2351,
  -2.27745,
  14.2714,
  -2.24218,
  1334.8,
  -1337.01,
  3.57529,
  1920.1,
  -4.92606,
  251.887,
  4.46934,
  4.72292,
  -3.43872,
  -1.00479,
  202.065,
  -985.927,
  -7.23517,
  -0.476987,
  -2.34023,
  2.23816,
  0.99729,
  -0.718301,
  -1.25958,
  499.558,
  4.40885,
  -2424.76,
  57.2344,
  -0.425221,
  0.923688,
  -1.20521,
  -0.569715,
  -0.378424,
  -0.0608559
 };

// Assignment to error coefficients vector.
static double gCoefficientRMS[] = {
  321.209,
  777.283,
  249.234,
  299.726,
  179.926,
  413.434,
  563.96,
  305.302,
  184.576,
  366.003,
  134.366,
  0.479962,
  369.846,
  832.2,
  764.902,
  85.7539,
  246.29,
  18.5231,
  39.2269,
  15.9249,
  8.34461,
  14.0374,
  2.38234,
  2.46821,
  330.532,
  1387.29,
  910.361,
  1881.71,
  2047.39,
  125.69,
  133.74,
  328.911,
  454.048,
  209.933,
  102.251,
  198.884,
  137.468,
  29.3213,
  200.015,
  294.338,
  296.142,
  356.376,
  351.352,
  13.6698,
  45.8822,
  4.15055,
  1008.39,
  11.0522,
  727.83,
  863.783,
  9.82672,
  876.688,
  10.6478,
  147.211,
  409.943,
  19.3292,
  12.7234,
  4.7833,
  489.772,
  559.717,
  40.5332,
  4.46826,
  15.1781,
  15.5849,
  2.2723,
  2.81319,
  10.0794,
  1204.86,
  36.1467,
  1376.97,
  183.953,
  12.0172,
  14.6294,
  12.3884,
  11.8182,
  11.1776,
  14.9338
 };

// Assignment to powers vector.
// The powers are stored row-wise, that is
//  p_ij = gPower[i * NVariables + j];
static int    gPower[] = {
  1,  1,  1,  1,  1,  1,
  1,  1,  1,  1,  1,  2,
  2,  1,  1,  1,  1,  1,
  1,  1,  1,  1,  2,  1,
  1,  1,  2,  1,  1,  1,
  1,  1,  1,  1,  2,  2,
  2,  1,  2,  1,  1,  1,
  1,  1,  2,  1,  1,  2,
  1,  1,  3,  1,  1,  1,
  2,  1,  1,  1,  1,  2,
  3,  1,  1,  1,  1,  1,
  1,  1,  1,  1,  3,  1,
  1,  2,  1,  2,  1,  1,
  1,  1,  2,  1,  2,  1,
  2,  1,  1,  1,  2,  1,
  1,  1,  1,  3,  1,  1,
  1,  1,  1,  1,  2,  3,
  2,  1,  1,  3,  1,  1,
  2,  2,  1,  2,  1,  1,
  1,  2,  1,  2,  2,  1,
  1,  1,  1,  3,  2,  1,
  3,  1,  1,  2,  1,  1,
  2,  1,  1,  1,  3,  1,
  1,  1,  2,  1,  3,  1,
  3,  1,  1,  1,  1,  2,
  2,  1,  2,  1,  1,  2,
  1,  2,  1,  2,  1,  2,
  2,  1,  1,  1,  2,  2,
  1,  1,  2,  1,  2,  2,
  1,  1,  2,  1,  1,  3,
  1,  3,  1,  1,  1,  1,
  1,  3,  1,  1,  1,  2,
  1,  1,  3,  1,  1,  2,
  1,  1,  1,  3,  1,  2,
  1,  1,  1,  2,  1,  3,
  1,  2,  1,  1,  1,  1,
  1,  1,  1,  2,  1,  1,
  1,  1,  1,  1,  1,  3,
  1,  1,  1,  2,  1,  2,
  1,  2,  1,  1,  1,  2,
  2,  1,  1,  2,  1,  1,
  1,  1,  1,  2,  2,  1,
  1,  1,  2,  2,  1,  1,
  1,  2,  1,  3,  1,  1,
  2,  1,  2,  2,  1,  1,
  1,  3,  1,  1,  2,  1,
  2,  2,  1,  1,  1,  2,
  1,  3,  2,  1,  1,  1,
  2,  1,  1,  2,  1,  2,
  1,  1,  2,  2,  1,  2,
  3,  1,  2,  1,  1,  1,
  1,  1,  1,  2,  2,  2,
  2,  3,  1,  1,  1,  1,
  1,  2,  1,  1,  1,  3,
  2,  2,  1,  1,  1,  1,
  1,  1,  2,  3,  1,  1,
  1,  3,  1,  2,  1,  1,
  1,  1,  3,  1,  2,  1,
  1,  2,  2,  1,  1,  1,
  1,  2,  1,  1,  2,  1,
  1,  2,  2,  2,  1,  1,
  3,  1,  1,  1,  2,  1,
  2,  1,  1,  2,  2,  1,
  1,  1,  2,  2,  2,  1,
  1,  2,  1,  1,  3,  1,
  1,  1,  1,  2,  3,  1,
  2,  1,  3,  1,  1,  1,
  1,  2,  2,  1,  1,  2,
  2,  2,  2,  1,  1,  1,
  1,  2,  1,  1,  2,  2,
  2,  1,  1,  1,  1,  3,
  2,  2,  1,  1,  2,  1,
  2,  1,  2,  1,  2,  1,
  1,  2,  2,  1,  2,  1,
  1,  2,  3,  1,  1,  1,
  3,  2,  1,  1,  1,  1,
  1,  1,  3,  2,  1,  1
};

// 
// The function   double MDF(double *x)
// 
double MDF(double *x) {
  double returnValue = gDMean;
  int    i = 0, j = 0, k = 0;
  for (i = 0; i < gNCoefficients ; i++) {
    // Evaluate the ith term in the expansion
    double term = gCoefficient[i];
    for (j = 0; j < gNVariables; j++) {
      // Evaluate the polynomial in the jth variable.
      int power = gPower[gNVariables * i + j]; 
      double p1 = 1, p2 = 0, p3 = 0, r = 0;
      double v =  1 + 2. / (gXMax[j] - gXMin[j]) * (x[j] - gXMax[j]);
      // what is the power to use!
      switch(power) {
      case 1: r = 1; break; 
      case 2: r = v; break; 
      default: 
        p2 = v; 
        for (k = 3; k <= power; k++) { 
          p3 = p2 * v;
          p3 = 2 * v * p2 - p1; 
          p1 = p2; p2 = p3; 
        }
        r = p3;
      }
      // multiply this term by the poly in the jth var
      term *= r; 
    }
    // Add this term to the final result
    returnValue += term;
  }
  return returnValue;
}

// EOF for O24_length.C
